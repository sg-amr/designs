# Aoristos main-site 基礎設計

Team Aoristosのメインサイト。（4回目）

#### 目的：
- 知名度を上げる。
- SNSだけではわかりにくい体系的な情報を伝える。
- 活動の日記・備忘録。
- 情報班の実践経験。

#### 具体的目標：
- Xでのフォロワー300人越え。
- 複数のクラウドサービスを超えたシステム開発を学ぶ

## 用件定義

#### 公開したい情報：
- Aoristosの定義・概要・発端などチーム全体についてのこと（静的）
- 大会での成果のまとめ・それぞれについての詳しい記述（静的）
- 毎日の活動の詳細（動的）
- メンバーそれぞれの情報（静的）
- 情報班の成果物（静的）

#### 方向性：

- できるだけ無料で運用
- スピード重視の軽いサイトを目指す
- SEO対策にもきちんと取り組む

## 基本設計

## データベース

MD・画像などのデータは以下のGitレポジトリに保存する。
https://github.com/sg-amr/main-site-assets

認証情報などは、Xserverで動作するSQLに保存する。

なお、どちらもDBと呼ぶことにする。

## バックエンド
Next.jsのAPIサーバーでDBのラッパーとする。
Vercelにデプロイする。

## フロントエンド
AstroのSSGをGithubActionで行い、GithubPagesで静的に配信する。

### 前提

- "~/hoge/hoge"は"https://www.aoristos.com/hoge/hoge"を表す。

- "/hoge/hoge"はプロジェクトのルートからの相対パスを表す。

- ":/"はDBレポジトリのルートを表す

- "[hoge]"は動的ルーティングを表す

- 情報は以下に分類される。
    - 静的データ    : 運用中に変更することがないもの
        - Astroのコンポーネントファイルに直接書き込む文章
        - publicディレクトリにそのまま保存する画像
        - 各種変更する予定のないJavaScript・html・css等
    - 動的データ    : 運用中に変更するもしくは変更する可能性のあるもの
        - 各記事のhtmlファイル・画像など
    - メタデータ    : 一般公開しない情報・小さな情報
        - 管理者の認証情報
        - 記事の管理など

### その他

- TypeScriptを用いる

- XSS攻撃を防ぐため全てのアセットデータに生HTMLは含まない。

- Astroを活かすため情報班の成果物のページ以外にはAstroコンポーネントのみ使う。特にReactコンポーネントはレンダリング場所を問わず禁止。

- 1ファイル1コンポーネントを厳守する。

- cssフレームワークはtailwindを使用する

- 3D表現を行うときは必ずThree.jsを使用する。

### 本番環境について

ドメイン料を除き完全無料で運用する。

### 使用するサービス一覧

#### Github Pages

本サイトの静的ホスティング（Astro SSG）

https://www.aoristos.net

#### Github Actions

サイトの一週間ごとの自動ビルド（Astro build）

#### Vercel Next.js Project Hosting

管理用サイトのホスティング（Next.js SSR）<br />
SQLサーバーのラッパー

https://admin.aoristos.net

#### Xserver

SQLサーバー

#### Cloud Flare

以上のクラウドシステムのDNSサーバー・プロキシ化（一部）

### 使用する全てのソース

- フロントエンド（Astroプロジェクト）
- バックエンド・管理サイトのフロントエンド（Next.jsプロジェクト）

> 後者を単にバックエンドと呼ぶことにする

### 各ファイルの案内

#### 設計文書
- index.md     : 基礎設計
- db.md        : DB構造の定義
- front.md     : フロントエンド
- back.md      : バックエンド

#### APIリファレンス
- references   : APIリファレンス<br/>
（詳しくは./references/index.mdを参照）